version: 0.2

run-as: root

env:
  parameter-store:
            DB_NAME: "/divye/dbName"
            DB_HOST: "/divye/dbEndpoint"
            DB_USER: "/divye/DbUser"
            DB_PASSWORD: "/divye/DbPassword"
  
phases:
  pre_build:
    commands:
            - sudo apt get update -y
            - echo "Installing Wordpress dependencies"
            - sudo apt install nginx -y
            - sudo apt install php php-fpm -y
            
  build:
    commands:
            - sed -i 's/database_name_here/'$DB_NAME'/' wp-config.php
            - sed -i 's/username_here/'$DB_USER'/' wp-config.php
            - sed -i 's/password_here/'$DB_PASSWORD'/' wp-config.php
            - sed -i 's/localhost/'$DB_HOST'/' wp-config.php
            - printenv
            
artifacts:
  files: 
      echo "Creating Artifacts"
      - '**/*'

